{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>littlebubs </title>
    <meta charset="utf-8">
    <script src="https://cdn.razorpay.com/static/widget/checkout.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="{% static 'images/qq.png' %}" rel="icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,400,700"> 
    <link rel="stylesheet" href="{% static 'fonts/icomoon/style.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">


    <link rel="stylesheet" href="{% static 'css/aos.css' %}">

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
      a{
        color:black;
      }
    </style>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
   
  </head>
  <body>
  

    <div class="site-wrap">
      <header class="site-navbar" role="banner" style="position: sticky; top: 0; z-index: 100;">
        <div class="site-navbar-top"  style="padding-top: 0px; padding-bottom: 0px;">
          <div class="container">
            <div class="row align-items-center">
    
              <div class="col-6 col-md-4 order-2 order-md-1 site-search-icon text-left">
                <form action="{% url 'buttercheecks:product_search' %}" class="site-block-top-search">
                  <span class="icon icon-search2"></span>
                  <input type="text" class="form-control border-0"  name="q" placeholder="Search products">
                </form>
              </div>
              <div class="col-12 col-md-4 order-1 order-md-2 text-center">
                <div class="site-logo">
                    <img src="{% static 'images/logo.png' %}" alt="Little Bubs Logo" class="img-fluid" style="max-width: 100%; height: auto; max-height: 100px; width: auto;">
                </div>
            </div>
            
              <div class="col-6 col-md-4 order-3 order-md-3 text-right">
                <div class="site-top-icons">
                  <ul>
                    {% if user.is_authenticated %}
                    
                   
                    <div class="user-dropdown">
                      <div class="user-profile">
                        <span class="icon icon-user"></span><p></p>
                      </div>
                      <div class="dropdown-content">
                       
                      <div class="dropdown-content">
                        <a href="{% url 'buttercheecks:orders' %}">My Orders & Returns</a>
                        <a href="{% url 'buttercheecks:user_profile' %}">My Account</a>
                        <a href="{% url 'buttercheecks:logout' %}">Logout</a>
                       
                        
                      </div>
                    </div>
                    <li>
                      <a href="{% url 'buttercheecks:cart' %}" class="site-cart">
                        <span class="icon icon-shopping_cart"></span>
                        <span class="count">{{ cart_count }}</span>
                      </a>
                    </li> 
                    
                    <li><a href="{% url 'buttercheecks:logout' %}"<i class="icon icon-sign-out"></i></a></li>
                   
                 
                    {% else %}
                   
                    <li>
                      <a href="{% url 'buttercheecks:cart' %}" class="site-cart">
                        <span class="icon icon-shopping_cart"></span>
                       
                      </a>
                    </li> 
                    
                    <li><a href="{% url 'buttercheecks:signup_login' %}"<i class="icon icon-sign-out"></i></a></li>
                    <div class="user-dropdown">
                      <div class="user-profile">
                        <span class="icon icon-user"></span><p></p>
                      </div>
                      <div class="dropdown-content">
                        <a href="{% url 'buttercheecks:signup_login' %}">Login/signin</a>
                      
                 
                       
                        
                      </div>
                    </div>
                    {% endif %}
                    <li class="d-inline-block d-md-none ml-md-0"><a href="#" class="site-menu-toggle js-menu-toggle"><span class="icon-menu"></span></a></li>
                  </ul>
                </div> 
              </div>
    
            </div>
          </div>
        </div>  <style>.user-dropdown {
          position: relative;
          display: inline-block;
        }
        
        .user-profile {
          display: inline-block;
          cursor: pointer;
          padding: 5px 10px;
         
          color: #A0A8C0;
          border-radius: 3px;
        }
        
        .dropdown-content {
          display: none;
          position: absolute;
          background-color: white;
          min-width: 160px;
          box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
          z-index: 1;
        }
        
        .dropdown-content a {
          display: block;
          padding: 10px 15px;
          text-decoration: none;
          color: #333;
          transition: background-color 0.3s;
        }
        
        .dropdown-content a:hover {
          background-color: #B7D1E3;
          color: white;
        }
        
        .user-dropdown:hover .dropdown-content {
          display: block;
        }
         </style> 
      
        <nav class="site-navigation text-right text-md-center" role="navigation" >
          <div class="container">
            <ul class="site-menu js-clone-nav d-none d-md-block">
              <li>
                <a href="{% url 'buttercheecks:home' %}" style="color: black;">Home</a>
              </li>
             
             
              <li><a href="{% url 'buttercheecks:product_list_by_category' 'BABY_SWADDLES' %}" style="color: black;">Baby Swaddles</a></li>
              <li><a href="{% url 'buttercheecks:product_list_by_category' 'BABY_ROMBERS' %}" style="color: black;">Baby Rombers</a></li>
              <li><a href="{% url 'buttercheecks:product_list_by_category' 'BABY_JABLAS' %}" style="color: black;">Baby Jablas</a></li>
              <li><a href="{% url 'buttercheecks:product_list_by_category' 'BABY_BLANKETS' %}"style="color: black;">Baby Blankets</a></li>
              
              <li>
                <a href="{% url 'buttercheecks:about' %}" style="color: black;">About</a>
              </li>
             
            </ul>
          </div>
        </nav>
        <nav class="site-navigation text-right text-md-center" role="navigation" style="background-color:#B9D1E4;">
          <div class="container">
            <ul class="site-menu js-clone-nav d-none d-md-block">
              <li>
                <a href="{% url 'buttercheecks:home' %}" style="color: white;"> Free Shipping on Orders â‚¹500+* Shop Now
                </a>
              </li>
             
              
            </ul>
          </div>
        </nav>
        
      </header>
    <div class="bg-light py-3">
      <div class="container">
        <div class="row">
          <div class="col-md-12 mb-0"><a href="index.html">Home</a> <span class="mx-2 mb-0">/</span> <a href="cart.html">Cart</a> <span class="mx-2 mb-0">/</span> <strong class="text-black">Checkout</strong></div>
        </div>
      </div>
    </div>

    <div class="site-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md-12">
            <div class="border p-4 rounded" role="alert">
             Add a Shipping Address <a href="{% url 'buttercheecks:manage_addresses' %}" class="btn btn-primary"  style="background-color: #B9D1E4; color: white;" >Click here</a> 
            </div>
          </div>
        </div>
      
        <div class="container mt-5">
          <div class="row">
              <div class="col-md-6 offset-md-3">
                 
                  <div id="addressForm" class="collapse">
                    <form method="post">
                      {% csrf_token %}
                      <div>
                          <label for="id_first_name">First Name:</label>
                          <input type="text" id="id_first_name" name="first_name" maxlength="100" required class="form-control">
                      </div>
                      <div>
                          <label for="id_last_name">Last Name:</label>
                          <input type="text" id="id_last_name" name="last_name" maxlength="100" required class="form-control">
                      </div>
                      <div>
                          <label for="id_company_name">Company Name:</label>
                          <input type="text" id="id_company_name" name="company_name" maxlength="100" class="form-control">
                      </div>
                      <div>
                          <label for="id_address">Address:</label>
                          <input type="text" id="id_address" name="address" maxlength="255" required class="form-control">
                      </div>
                      <div>
                          <label for="id_apartment_suite">Apartment/Suite:</label>
                          <input type="text" id="id_apartment_suite" name="apartment_suite" maxlength="100" class="form-control">
                      </div>
                      <div>
                          <label for="id_state_country">State/Country:</label>
                          <input type="text" id="id_state_country" name="state_country" maxlength="100" required class="form-control">
                      </div>
                      <div>
                          <label for="id_postal_zip">Postal/Zip Code:</label>
                          <input type="text" id="id_postal_zip" name="postal_zip" maxlength="20" required class="form-control">
                      </div>
                      <div>
                          <label for="id_email">Email:</label>
                          <input type="email" id="id_email" name="email" required class="form-control">
                      </div>
                      <div>
                          <label for="id_phone">Phone:</label>
                          <input type="text" id="id_phone" name="phone" maxlength="20" required class="form-control">
                      </div>
                      <button type="submit">Submit</button>
                  </form>
                  </div>
              </div>
          </div>
      </div>
      
          <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">Checkout</div>
                        <div class="card-body">
                            <!-- Display the form for selecting shipping address here -->
        
                            <!-- Display the cart details and total -->
                            <h2 class="h3 mb-3 text-black">Your Order</h2>
                            <div class="p-3 p-lg-5 border">
                                <table class="table site-block-order-table mb-5">
                                    <thead>
                                        <tr>
                                            <th>Product</th>
                                            <th>Quantity</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for item in cart_items %}
                                        <tr>
                                            <td>
                                              <img src="{{ item.product.image.url }}" alt="{{ item.product.product_name }}" width="75" class="img-fluid" >
                                              <br>{{ item.product.product_name }}</td>
                                            <td>x {{ item.quantity }}</td>
                                            <td>${{ item.product.price }}</td>
                                        </tr>
                                        {% endfor %}
                                        <tr>
                                            <td class="text-black font-weight-bold" colspan="2"><strong>Order Total</strong></td>
                                            <td class="text-black font-weight-bold"><strong>${{ total_cart_price }}</strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
          
        <div class="container">
          <div class="row justify-content-center">
              <div class="col-md-8">
                  <div class="card">
                    <form method="post" id="checkoutForm">
                      {% csrf_token %}
              
                      <!-- Display user's addresses -->
                      <div class="form-group">
                          <label for="selected_shipping_address"><h4>Select Shipping Address:</h4></label>
                          <select class="form-control" id="selected_shipping_address" name="selected_shipping_address">
                              {% for address in addresses %}
                              <option value="{{ address.id }}">{{ address.apartment_suite }}, {{ address.address }},
                                  {{address.phone}}, {{address.state_country}}, {{address.postal_zip}}</option>
                              {% endfor %}
                          </select>
                      </div>
              
                      <!-- Other checkout form fields here (e.g., payment method) -->
                      <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id" value="">
                      <button type="button" class="btn btn-primary" id="rzp-button1" style="background-color: #B9D1E4; color: white;">Proceed to Payment</button>
                  </form>
                  {{request.user.username}}
                  <script>
                    var userName ="{{request.user.username}}";  // Django template syntax to get the username
    var userEmail = "{{ request.user.email }}";  // Django template syntax to get the email
                      var options = {
                          "key": "rzp_test_Rkc4b7aYhMc4IY",
                          "amount": {{ total_cart_price_in_paisa }},
                          "currency": "INR",
                          "name": "Littlebubs",
                          "description": "Test Transaction",
                          "image": "https://littlebubs.in/static/images/qq.png",
                          "order_id": "{{ order.razorpay_order_id }}",
                         
                          "handler": function (response) {
                              // Handle the payment response here
                              if (response.razorpay_payment_id) {
                                  // Submit the form on successful payment
                                  document.getElementById('razorpay_payment_id').value = response.razorpay_payment_id;
                                  document.getElementById('checkoutForm').submit();
                              } else {
                                  // Handle payment failure
                                  console.error('Payment failed:', response.error);
                              }
                          },
                          "prefill": {
                            "name":"{{request.user.username}}",  // Default to logged-in user's username
                            "email": "{{ request.user.email }}",  // Default to logged-in user's email
                            "contact": "{{ request.user.addresses }}"  // Default to logged-in user's contact number
                           
                          },
                        "notes": {
                            "address": "Razorpay Corporate Office"
                        },
                          "theme": {
                              "color": "#3399cc"
                          }
                      };
              
                      var rzp1 = new Razorpay(options);
              
                      rzp1.on('payment.failed', function (response) {
                          // Handle payment failure
                          console.error('Payment failed:', response.error);
                      });
              
                      document.getElementById('rzp-button1').onclick = function () {
                          rzp1.open();
                      };
                  </script>
  </div>    </div>    </div>    </div>    </div>   

  <br>  <br>
  


  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  
  
  
<!-- Footer -->
<footer class="site-navigation text-right text-md-center" role="navigation" style="background-color:#DFEEFA;">


  <!-- Section: Links  -->
  <section class="d-flex justify-content-center justify-content-lg-between p-4 border-bottom">
    
    <div class="container text-center text-md-start mt-5">
      <!-- Grid row -->
      <div class="row mt-3">
        <!-- Grid column -->
        <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
          <!-- Content -->
          <h6 class="text-uppercase fw-bold mb-4">
            <i class="fas fa-gem me-3">Little Bubs</i><div class="site-logo">
              <img src="{% static 'images/logo.png' %}" alt="Little Bubs Logo" class="img-fluid" style="max-width: 100%; height: auto; max-height: 100px; width: auto;">
          </div>
          </h6>
          <p>
            Here you can use rows and columns to organize your footer content. Lorem ipsum
            dolor sit amet, consectetur adipisicing elit.
          </p>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
          <!-- Links -->
          <h6 class="text-uppercase fw-bold mb-4">
            Products
          </h6>
          <p>
            <a href="#!" class="text-reset" >Baby Rombers</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Baby Jablas</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Baby Swaddles</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Baby Shirt and Shorts</a>
          </p>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
          <!-- Links -->
          <h6 class="text-uppercase fw-bold mb-4">
            Useful links
          </h6>
          <p>
            <a href="#!" class="text-reset">Pricing</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Settings</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Orders</a>
          </p>
          <p>
            <a href="#!" class="text-reset">Help</a>
          </p>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
          <!-- Links -->
          <h6 class="text-uppercase fw-bold mb-4">Contact</h6>
          <p><i class="fas fa-home me-3"></i>  NY 10012, US</p>
          <p>
            <i class="fas fa-envelope me-3"></i>
            info@littlebubs.com
          </p>
          <p><i class="fas fa-phone me-3"></i> + 01 234 567 88</p>
          <p><i class="fas fa-print me-3"></i> + 01 234 567 89</p>
        </div>
        <!-- Grid column -->
      </div>
      <!-- Grid row -->
    </div>
  </section>
  <!-- Section: Links  -->

  <!-- Copyright -->
  <div class="text-center p-4" style="background-color:#B9D1E4;">
    Â© 2023 Copyright:
    <a class="text-reset fw-bold" href="">Little Bubs.com</a>
  </div>
  <!-- Copyright -->
</footer>
<!-- Footer -->

  <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
  <script src="{% static 'js/jquery-ui.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/owl.carousel.min.js' %}"></script>
  <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'js/aos.js' %}"></script>
  <script src="{% static 'js/checkout.js' %}"></script>
  <script src="{% static 'js/main.js' %}"></script>
    
  </body>
</html>